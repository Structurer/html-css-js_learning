<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬åœ°å“ˆå¸Œè®¡ç®—å·¥å…·ï¼ˆå…¨ç®—æ³•ç‰ˆï¼‰</title>
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;}
        body {padding:20px;max-width:1200px;margin:0 auto;background:#f5f5f5;}
        .container {gap:20px;display:flex;flex-direction:column;}
        .title {text-align:center;color:#333;margin-bottom:10px;}
        .section {background:#fff;padding:18px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
        .section h3 {color:#444;margin-bottom:12px;font-size:16px;border-bottom:1px solid #eee;padding-bottom:8px;}
        #textInput {width:100%;height:100px;padding:10px;border:1px solid #ddd;border-radius:4px;resize:vertical;font-size:14px;}
        /* ç®—æ³•åˆ†ç±»æ ·å¼ï¼Œæ¯ç±»å•ç‹¬åˆ†ç»„ï¼Œæ¸…æ™°åŒºåˆ† */
        .algo-wrap {margin-top:8px;}
        .algo-category {font-size:15px;color:#2196F3;font-weight:600;margin:10px 0 6px 0;padding-left:4px;border-left:3px solid #2196F3;}
        .algo-group {display:flex;flex-wrap:wrap;gap:12px;margin-bottom:8px;}
        .algo-item {display:flex;align-items:center;gap:4px;font-size:14px;}
        .drag-area {width:100%;height:160px;border:2px dashed #ccc;border-radius:6px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#666;cursor:pointer;transition:all 0.3s;}
        .drag-area.active {border-color:#2196F3;background:#f0f8ff;color:#2196F3;}
        .drag-area p {text-align:center;font-size:14px;line-height:1.5;}
        #resultOutput {width:100%;height:300px;padding:10px;border:1px solid #ddd;border-radius:4px;resize:vertical;font-size:13px;line-height:1.4;background:#fafafa;white-space:pre-wrap;overflow-y:auto;}
        .btn-group {display:flex;gap:10px;margin-top:12px;}
        button {padding:8px 16px;border:none;border-radius:4px;background:#2196F3;color:#fff;cursor:pointer;font-size:14px;transition:background 0.2s;}
        button:hover {background:#1976D2;}
        button.clear {background:#f44336;}
        button.clear:hover {background:#d32f2f;}
        button.copy {background:#4CAF50;}
        button.copy:hover {background:#388E3C;}
        .loading {color:#2196F3;font-size:14px;text-align:center;display:none;margin-top:8px;}
    </style>
</head>
<body>
    <div class="container">
        <h2 class="title">æœ¬åœ°å“ˆå¸Œè®¡ç®—å·¥å…·ï¼ˆæ–‡æœ¬/æ–‡ä»¶/æ–‡ä»¶å¤¹ + CryptoJSå…¨ç®—æ³•ï¼‰</h2>

        <!-- 1. æ–‡æœ¬è¾“å…¥åŒº -->
        <div class="section">
            <h3>ä¸€ã€ æ–‡æœ¬å“ˆå¸Œè¾“å…¥</h3>
            <textarea id="textInput" placeholder="è¾“å…¥ä»»æ„æ–‡å­—ï¼Œæœ¬åœ°è®¡ç®—å¯¹åº”å“ˆå¸Œå€¼ï¼Œæ— æ•°æ®ä¸Šä¼ ..."></textarea>
        </div>

        <!-- 2. æ‹–æ‹½æ–‡ä»¶/æ–‡ä»¶å¤¹åŒºã€ä½ç½®ä¸Šç§»ï¼šæ”¾åœ¨ç®—æ³•é€‰åŒºä¸Šæ–¹ã€‘ -->
        <div class="section">
            <h3>äºŒã€ æ‹–æ‹½æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼ˆæ”¯æŒå•/å¤šæ–‡ä»¶+é€’å½’å­æ–‡ä»¶å¤¹ï¼‰</h3>
            <div id="dragArea" class="drag-area">
                <p>ğŸ–±ï¸ æ‹–æ‹½æ–‡ä»¶/æ–‡ä»¶å¤¹åˆ°æ­¤å¤„</p>
                <p>è‡ªåŠ¨é€’å½’éå†æ‰€æœ‰å­æ–‡ä»¶å¤¹å†…æ–‡ä»¶ï¼Œä»…æœ¬åœ°è§£æï¼Œä¸ä¸Šä¼ ä»»ä½•æ–‡ä»¶</p>
            </div>
        </div>

        <!-- 3. å“ˆå¸Œç®—æ³•é€‰æ‹©åŒºã€ä½ç½®ä¸‹ç§»ï¼šæ”¾åœ¨æ‹–æ‹½åŒºä¸‹æ–¹ã€‘â†’ 5ç±»ç®—æ³•å…¨é…é½ï¼Œåˆ†ç±»å±•ç¤º -->
        <div class="section">
            <h3>ä¸‰ã€ é€‰æ‹©å“ˆå¸Œç®—æ³•ï¼ˆ5å¤§ç±»å…¨æ”¯æŒï¼Œå¯å¤šé€‰ï¼Œæœ¬åœ°è®¡ç®—ï¼‰</h3>
            <div class="algo-wrap">
                <!-- ç¬¬1ç±»ï¼šMD5 -->
                <div class="algo-category">1. MD5</div>
                <div class="algo-group">
                    <label class="algo-item"><input type="checkbox" name="algo" value="MD5" checked> MD5ï¼ˆ128ä½ï¼‰</label>
                </div>

                <!-- ç¬¬2ç±»ï¼šSHA1 -->
                <div class="algo-category">2. SHA1</div>
                <div class="algo-group">
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-1"> SHA-1ï¼ˆ160ä½ï¼‰</label>
                </div>

                <!-- ç¬¬3ç±»ï¼šSHA2 ç³»åˆ— -->
                <div class="algo-category">3. SHA2 ç³»åˆ—ï¼ˆä¸»æµå®‰å…¨å“ˆå¸Œï¼‰</div>
                <div class="algo-group">
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-256" checked> SHA-256ï¼ˆ256ä½ï¼‰</label>
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-384"> SHA-384ï¼ˆ384ä½ï¼‰</label>
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-512" checked> SHA-512ï¼ˆ512ä½ï¼‰</label>
                </div>

                <!-- ç¬¬4ç±»ï¼šSHA3 ç³»åˆ—ï¼ˆæ–°ä¸€ä»£å“ˆå¸Œï¼‰ -->
                <div class="algo-category">4. SHA3 ç³»åˆ—ï¼ˆéœ€æŒ‡å®šè¾“å‡ºé•¿åº¦ï¼‰</div>
                <div class="algo-group">
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-3-224"> SHA3-224ï¼ˆ224ä½ï¼‰</label>
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-3-256"> SHA3-256ï¼ˆ256ä½ï¼‰</label>
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-3-384"> SHA3-384ï¼ˆ384ä½ï¼‰</label>
                    <label class="algo-item"><input type="checkbox" name="algo" value="SHA-3-512"> SHA3-512ï¼ˆ512ä½ï¼‰</label>
                </div>

                <!-- ç¬¬5ç±»ï¼šå°ä¼—å“ˆå¸Œ -->
                <div class="algo-category">5. å°ä¼—å“ˆå¸Œï¼ˆä¸“ç”¨åœºæ™¯ï¼‰</div>
                <div class="algo-group">
                    <label class="algo-item"><input type="checkbox" name="algo" value="RIPEMD-160"> RIPEMD-160ï¼ˆ160ä½ï¼‰</label>
                </div>
            </div>
        </div>

        <!-- 4. æ“ä½œæŒ‰é’® + åŠ è½½æç¤º -->
        <div class="btn-group">
            <button id="calcBtn">å¼€å§‹è®¡ç®—å“ˆå¸Œ</button>
            <button id="copyBtn" class="copy">å¤åˆ¶å…¨éƒ¨ç»“æœ</button>
            <button id="clearBtn" class="clear">æ¸…ç©ºæ‰€æœ‰å†…å®¹</button>
        </div>
        <div class="loading" id="loading">è®¡ç®—ä¸­... å¤§æ–‡ä»¶/æ–‡ä»¶å¤¹è¯·ç¨å€™ï¼ˆä»…æœ¬åœ°è®¡ç®—ï¼Œè€å¿ƒç­‰å¾…ï¼‰</div>

        <!-- 5. ç»“æœè¾“å‡ºåŒº -->
        <div class="section">
            <h3>å››ã€ å“ˆå¸Œè®¡ç®—ç»“æœï¼ˆæ¸…æ™°åˆ—è¡¨å±•ç¤ºï¼Œå¯ç›´æ¥å¤åˆ¶ï¼‰</h3>
            <textarea id="resultOutput" readonly placeholder="è®¡ç®—ç»“æœå°†å±•ç¤ºåœ¨è¿™é‡Œ..."></textarea>
        </div>
    </div>

    <script>
        // å…¨å±€DOMè·å–
        const textInput = document.getElementById('textInput');
        const dragArea = document.getElementById('dragArea');
        const resultOutput = document.getElementById('resultOutput');
        const calcBtn = document.getElementById('calcBtn');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');
        const loading = document.getElementById('loading');
        const algoCheckboxes = document.querySelectorAll('input[name="algo"]');
        let fileList = []; // å­˜å‚¨æ‹–æ‹½çš„æ–‡ä»¶ï¼ˆå®Œæ•´è·¯å¾„+æ–‡ä»¶å¯¹è±¡ï¼‰

        // ========== æ ¸å¿ƒä¿®å¤ï¼šå…¨å±€é˜»æ­¢æ‹–æ‹½é»˜è®¤è¡Œä¸ºï¼Œä»…æ‹–æ‹½æ¡†å¯æ¥æ”¶æ–‡ä»¶ï¼Œåˆ«å¤„æ— ååº” ==========
        document.addEventListener('dragover', (e) => e.preventDefault());
        document.addEventListener('drop', (e) => e.preventDefault());

        // ========== æ ¸å¿ƒå·¥å…·å‡½æ•° ==========
        // 1. è·å–é€‰ä¸­çš„å“ˆå¸Œç®—æ³•
        function getSelectedAlgos() {
            return Array.from(algoCheckboxes).filter(box => box.checked).map(box => box.value);
        }

        // 2. å…¨ç®—æ³•å“ˆå¸Œè®¡ç®—ï¼ˆCryptoJSå®ç°ï¼Œè¦†ç›–5å¤§ç±»æ‰€æœ‰ç®—æ³•ï¼Œæ— å…¼å®¹æŠ¥é”™ï¼‰
        function calcTextHashByCryptoJS(text) {
            const algos = getSelectedAlgos();
            if (algos.length === 0) return 'è¯·è‡³å°‘é€‰æ‹©ä¸€ç§å“ˆå¸Œç®—æ³•å†è®¡ç®—ï¼';
            let result = `ã€æ–‡æœ¬å“ˆå¸Œã€‘è¾“å…¥å†…å®¹ï¼š${text.trim()}\n`;
            algos.forEach(algo => {
                let hash = '';
                switch(algo) {
                    // 1. MD5
                    case 'MD5': hash = CryptoJS.MD5(text).toString(); break;
                    // 2. SHA1
                    case 'SHA-1': hash = CryptoJS.SHA1(text).toString(); break;
                    // 3. SHA2 ç³»åˆ—
                    case 'SHA-256': hash = CryptoJS.SHA256(text).toString(); break;
                    case 'SHA-384': hash = CryptoJS.SHA384(text).toString(); break;
                    case 'SHA-512': hash = CryptoJS.SHA512(text).toString(); break;
                    // 4. SHA3 ç³»åˆ—ï¼ˆæŒ‡å®šoutputLengthå¯¹åº”ç®—æ³•ï¼‰
                    case 'SHA-3-224': hash = CryptoJS.SHA3(CryptoJS.enc.Utf8.parse(text), { outputLength: 224 }).toString(); break;
                    case 'SHA-3-256': hash = CryptoJS.SHA3(CryptoJS.enc.Utf8.parse(text), { outputLength: 256 }).toString(); break;
                    case 'SHA-3-384': hash = CryptoJS.SHA3(CryptoJS.enc.Utf8.parse(text), { outputLength: 384 }).toString(); break;
                    case 'SHA-3-512': hash = CryptoJS.SHA3(CryptoJS.enc.Utf8.parse(text), { outputLength: 512 }).toString(); break;
                    // 5. å°ä¼—å“ˆå¸Œ
                    case 'RIPEMD-160': hash = CryptoJS.RIPEMD160(text).toString(); break;
                    default: hash = `ã€ä¸æ”¯æŒã€‘ç®—æ³•${algo}æš‚æœªé€‚é…`;
                }
                result += `â””â”€â”€ ${algo}ï¼š${hash}\n`;
            });
            return result + '\n';
        }

        // 3. æ–‡ä»¶å“ˆå¸Œè®¡ç®—ï¼ˆè¦†ç›–5å¤§ç±»æ‰€æœ‰ç®—æ³•ï¼Œæ”¯æŒå¤§æ–‡ä»¶åˆ†å—è¯»å–ï¼‰
        function calcFileHashByCryptoJS(file) {
            return new Promise(resolve => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const wordArray = CryptoJS.lib.WordArray.create(e.target.result); // æ–‡ä»¶äºŒè¿›åˆ¶è½¬WordArray
                    const algos = getSelectedAlgos();
                    let result = '';
                    algos.forEach(algo => {
                        let hash = '';
                        switch(algo) {
                            // 1. MD5
                            case 'MD5': hash = CryptoJS.MD5(wordArray).toString(); break;
                            // 2. SHA1
                            case 'SHA-1': hash = CryptoJS.SHA1(wordArray).toString(); break;
                            // 3. SHA2 ç³»åˆ—
                            case 'SHA-256': hash = CryptoJS.SHA256(wordArray).toString(); break;
                            case 'SHA-384': hash = CryptoJS.SHA384(wordArray).toString(); break;
                            case 'SHA-512': hash = CryptoJS.SHA512(wordArray).toString(); break;
                            // 4. SHA3 ç³»åˆ—
                            case 'SHA-3-224': hash = CryptoJS.SHA3(wordArray, { outputLength: 224 }).toString(); break;
                            case 'SHA-3-256': hash = CryptoJS.SHA3(wordArray, { outputLength: 256 }).toString(); break;
                            case 'SHA-3-384': hash = CryptoJS.SHA3(wordArray, { outputLength: 384 }).toString(); break;
                            case 'SHA-3-512': hash = CryptoJS.SHA3(wordArray, { outputLength: 512 }).toString(); break;
                            // 5. å°ä¼—å“ˆå¸Œ
                            case 'RIPEMD-160': hash = CryptoJS.RIPEMD160(wordArray).toString(); break;
                            default: hash = `ã€ä¸æ”¯æŒã€‘ç®—æ³•${algo}æš‚æœªé€‚é…`;
                        }
                        result += `â””â”€â”€ ${algo}ï¼š${hash}\n`;
                    });
                    resolve(result);
                };
                reader.readAsArrayBuffer(file); // äºŒè¿›åˆ¶è¯»å–ï¼Œæ”¯æŒå¤§æ–‡ä»¶
            });
        }

        // ========== æ–‡ä»¶/æ–‡ä»¶å¤¹é€’å½’å¤„ç† ==========
        // é€’å½’éå†æ–‡ä»¶å¤¹ï¼Œè·å–æ‰€æœ‰å­æ–‡ä»¶ï¼ˆå«æ·±å±‚å­æ–‡ä»¶å¤¹ï¼‰
        async function traverseFolder(entry, path = '') {
            const fullPath = path ? `${path}/${entry.name}` : entry.name;
            if (entry.isFile) {
                return new Promise(resolve => {
                    entry.file(file => {
                        fileList.push({ path: fullPath, file });
                        resolve();
                    });
                });
            } else if (entry.isDirectory) {
                const reader = entry.createReader();
                return new Promise(resolve => {
                    const readEntries = () => {
                        reader.readEntries(entries => {
                            if (entries.length === 0) {
                                resolve();
                                return;
                            }
                            Promise.all(entries.map(e => traverseFolder(e, fullPath))).then(readEntries);
                        });
                    };
                    readEntries();
                });
            }
        }

        // æ‰¹é‡è®¡ç®—æ–‡ä»¶/æ–‡ä»¶å¤¹å“ˆå¸Œ
        async function calcFilesHash() {
            if (fileList.length === 0) return '';
            let result = `ã€æ‰¹é‡æ–‡ä»¶å“ˆå¸Œã€‘å…±è¯†åˆ« ${fileList.length} ä¸ªæ–‡ä»¶ï¼ˆå«é€’å½’å­æ–‡ä»¶å¤¹å†…æ–‡ä»¶ï¼‰\n`;
            for (const { path, file } of fileList) {
                result += `\nã€æ–‡ä»¶å“ˆå¸Œã€‘å®Œæ•´è·¯å¾„ï¼š${path}\n`;
                result += await calcFileHashByCryptoJS(file);
            }
            return result + '\n';
        }

        // ========== æ‹–æ‹½åŠŸèƒ½å®ç°ï¼ˆä»…æ‹–æ‹½æ¡†å¯æ¥æ”¶æ–‡ä»¶ï¼‰ ==========
        dragArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            dragArea.classList.add('active');
        });
        dragArea.addEventListener('dragleave', () => {
            dragArea.classList.remove('active');
        });
        dragArea.addEventListener('drop', async (e) => {
            e.preventDefault();
            dragArea.classList.remove('active');
            fileList = []; // æ¸…ç©ºæ—§æ–‡ä»¶åˆ—è¡¨

            const items = e.dataTransfer.items;
            if (!items.length) return;
            // è§£ææ‹–æ‹½çš„æ–‡ä»¶/æ–‡ä»¶å¤¹
            for (const item of items) {
                const entry = item.webkitGetAsEntry();
                if (entry) await traverseFolder(entry);
            }
            // æç¤ºè¯†åˆ«ç»“æœ
            if (fileList.length > 0) {
                resultOutput.value += `âœ… å·²æˆåŠŸè¯†åˆ«ï¼š${fileList.length} ä¸ªæ–‡ä»¶ï¼ˆå«é€’å½’å­æ–‡ä»¶å¤¹å†…æ–‡ä»¶ï¼‰\n\n`;
            }
        });

        // ========== æŒ‰é’®ç‚¹å‡»äº‹ä»¶ ==========
        // å¼€å§‹è®¡ç®—å“ˆå¸Œï¼ˆæ–‡æœ¬+æ–‡ä»¶åŒåœºæ™¯ï¼‰
        calcBtn.addEventListener('click', async () => {
            loading.style.display = 'block';
            resultOutput.value = '';
            let finalResult = '';

            // è®¡ç®—æ–‡æœ¬å“ˆå¸Œï¼ˆæœ‰è¾“å…¥æ‰è®¡ç®—ï¼‰
            if (textInput.value.trim()) {
                finalResult += calcTextHashByCryptoJS(textInput.value);
            }
            // è®¡ç®—æ–‡ä»¶å“ˆå¸Œï¼ˆæœ‰æ–‡ä»¶æ‰è®¡ç®—ï¼‰
            if (fileList.length > 0) {
                finalResult += await calcFilesHash();
            }
            // æ— è¾“å…¥æç¤º
            if (!finalResult) {
                finalResult = 'è¯·å…ˆè¾“å…¥æ–‡æœ¬ æˆ– æ‹–æ‹½æ–‡ä»¶/æ–‡ä»¶å¤¹åå†è®¡ç®—ï¼';
            }
            resultOutput.value = finalResult;
            loading.style.display = 'none';
        });

        // å¤åˆ¶å…¨éƒ¨ç»“æœåˆ°å‰ªè´´æ¿
        copyBtn.addEventListener('click', async () => {
            if (!resultOutput.value.trim()) return;
            await navigator.clipboard.writeText(resultOutput.value);
            alert('âœ… å“ˆå¸Œè®¡ç®—ç»“æœå·²æˆåŠŸå¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        });

        // æ¸…ç©ºæ‰€æœ‰å†…å®¹ï¼ˆæ–‡æœ¬+ç»“æœ+æ–‡ä»¶åˆ—è¡¨+æ¢å¤é»˜è®¤å‹¾é€‰ç®—æ³•ï¼‰
        clearBtn.addEventListener('click', () => {
            textInput.value = '';
            resultOutput.value = '';
            fileList = [];
            // é»˜è®¤å‹¾é€‰ï¼šMD5ã€SHA-256ã€SHA-512ï¼ˆå¸¸ç”¨æ ¸å¿ƒç®—æ³•ï¼‰
            algoCheckboxes.forEach(box => {
                box.checked = ['MD5', 'SHA-256', 'SHA-512'].includes(box.value);
            });
        });
    </script>
</body>
</html>